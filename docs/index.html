<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1, viewport-fit=cover" />
  <title>Mijoro Boutique — Version Pro</title>
  
  <!-- PWA Meta Tags -->
  <meta name="theme-color" content="#1e88e5">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Mijoro">
  
  <!-- Description -->
  <meta name="description" content="Boutique de produits numériques malagasy - eBooks, vidéos et applications pour réussir en ligne">
  
  <!-- PWA Manifest -->
  <link rel="manifest" href="manifest.json">
  
  <!-- Icons -->
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/icon-96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/icon-72.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/icon-192.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/icon-152.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/icon-128.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/icon-128.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/icon-96.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72.png">
  <link rel="apple-touch-icon" href="/icons/icon-192.png">
  
  <!-- Fonts & Icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

  <!-- Styles -->
  <link rel="stylesheet" href="style.css">
  
  <!-- Preconnect for performance -->
  <link rel="preconnect" href="https://i.ibb.co">
  <link rel="preconnect" href="https://zogohkfzplcuonkkfoov.supabase.co">
  <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">
  
  <!-- Microsoft Tiles -->
  <meta name="msapplication-TileColor" content="#1e88e5">
  <meta name="msapplication-TileImage" content="/icons/icon-144.png">
  <meta name="msapplication-config" content="browserconfig.xml">
 
  <noscript>
    <style>
      #loader{ display:none !important; }
      .bottom-menu{ display:flex !important; }
      section{ display:block !important; }
    </style>
  </noscript>
</head>
<body aria-busy="true">

<!-- ========================================
     LOADER PREMIUM
     ======================================== -->
<div id="loader" aria-hidden="false" role="status" aria-label="Chargement">
  <div class="loader-container">
    <div class="icon-wrapper">
      <svg class="boutique-icon" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
        <path d="M50 10 L70 30 L70 70 L50 90 L30 70 L30 30 Z" stroke-width="2" fill="none" />
        <circle cx="50" cy="50" r="15" stroke-width="2" fill="none" />
        <path d="M50 35 L50 25 M50 75 L50 65 M35 50 L25 50 M75 50 L65 50" stroke-width="2" stroke-linecap="round" />
      </svg>
      <div class="ring ring-1"></div>
      <div class="ring ring-2"></div>
    </div>
    
    <div class="boutique-name">MiJORO BOUTIQUE</div>
    
    <div class="loading-dots">
      <div class="dot"></div>
      <div class="dot"></div>
      <div class="dot"></div>
    </div>
  </div>
</div>

<!-- ========================================
     HOME SECTION
     ======================================== -->
<section id="home" class="active" aria-label="Accueil" aria-hidden="false">
  
  <!-- Slideshow -->
  <div class="slideshow" aria-label="Promotion">
    <div class="slide-track" id="slide-track">
      <!-- Slides rendered by JS -->
    </div>
    <div class="slide-dots" id="slide-dots" aria-hidden="true"></div>
  </div>
  
  <!-- Add Slide Button (Owner only) -->
  <div style="margin-top:16px; display:flex; justify-content:center; padding:0 12px">
    <button 
      id="btnAddSlide" 
      type="button" 
      class="param-btn owner-tool" 
      style="display:none; gap:6px; align-items:center" 
      title="Ajouter un slide" 
      aria-label="Ajouter un slide au carrousel"
      data-i18n="slide_add"
      data-i18n-title="slide_add">
      <i class="fa-solid fa-plus"></i>
      <span>Ajouter Slide</span>
    </button>
  </div>
  
  <!-- Subscribe Button -->
  <div style="margin-top:20px; display:flex; justify-content:center; padding:0 12px">
    <button 
      id="btnSubscribe" 
      type="button" 
      class="subscribe-btn"
      title="Recevoir les notifications de nouveaux produits"
      aria-label="S'abonner aux notifications"
      data-i18n-title="notif_subscribe">
      <i class="fa-solid fa-bell"></i>
      <span class="subscribe-text" data-i18n="notif_subscribe">S'abonner aux notifications</span>
    </button>
  </div>
  
  <!-- Home Title & Subtitle -->
  <h1 id="home-title" data-i18n="home_title">Tongasoa eto amin'ny fivarotana Malagasy!</h1>
  <p id="home-sub" data-i18n="home_sub">Découvre des eBooks, vidéos et apps/jeux pour t'aider à réussir en ligne.</p>
</section>

<!-- ========================================
     QUICK ORDER MODULE (COLLAPSIBLE)
     ======================================== -->
<div id="quick-order-section" style="margin-top:20px; padding:0 12px">
  <div class="quick-order-card">
    <!-- Header avec bouton toggle -->
    <div class="qo-header" style="display:flex;justify-content:space-between;align-items:center;">
      <div style="display:flex;align-items:center;gap:10px;">
        <i class="fa-solid fa-bolt"></i>
        <h3 style="margin:0;" data-i18n="quick_order_title">Commande Express</h3>
      </div>
      <button 
        id="qoToggle" 
        type="button" 
        class="qo-toggle-btn"
        aria-label="Réduire/Agrandir commande express"
        aria-expanded="true"
        style="width:32px;height:32px;border:none;border-radius:8px;background:rgba(255,255,255,0.08);color:#fff;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all 0.3s ease;">
        <i class="fa-solid fa-chevron-up"></i>
      </button>
    </div>
    
    <!-- Contenu collapsible -->
    <div id="qoContent" style="overflow:hidden;transition:max-height 0.3s ease,opacity 0.2s ease;">
      <div class="qo-grid" id="featured-products">
        <!-- Produits vedettes seront chargés ici par JS -->
      </div>
    </div>
  </div>
</div>

<!-- ========================================
     SHOP SECTION
     ======================================== -->
<section id="shop" class="section" aria-label="Boutique - Produits numériques" aria-hidden="true">
  
  <!-- ========== HEADER FIXE (Tools + Filters + Search) ========== -->
  <div id="shop-header">
    
    <!-- Tools toggle button (gear) -->
    <div style="padding: 8px 10px;">
      <button
        id="shopToolsToggle"
        class="tools-toggle"
        type="button"
        aria-label="Afficher/Masquer les outils du shop"
        aria-expanded="false"
        aria-controls="shop-tools"
        style="display:inline-flex;align-items:center;justify-content:center;width:40px;height:40px;border-radius:10px;border:none;cursor:pointer;color:#fff;background:linear-gradient(180deg, color-mix(in srgb, #334155 92%, #fff 8%), #334155);box-shadow:0 8px 18px rgba(0,0,0,.25);">
        <i class="fa-solid fa-sliders" style="font-size:16px;"></i>
      </button>
    </div>

    <!-- SHOP TOOLS (collapse section) -->
    <div id="shop-tools" class="shop-tools" role="region" aria-label="Outils de la boutique" style="overflow:clip;max-height:0;opacity:0;transform:translateY(-6px);transition:max-height .28s ease,opacity .18s ease,transform .28s ease;pointer-events:none;margin:0 10px;">
      
      <!-- Topbar: titre + actions -->
      <header class="shop-topbar" role="banner"
        style="display:grid;grid-template-columns:1fr auto 1fr;align-items:center;min-height:52px;padding:8px 4px;">
        <h2 class="shop-title"
          data-i18n="shop_title"
          style="grid-column:2;justify-self:center;margin:0;font-size:18px;font-weight:800;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">
          Nos Produits Numériques
        </h2>

        <div class="shop-actions"
          style="grid-column:3;justify-self:end;display:inline-flex;align-items:center;gap:8px;margin-right:max(2px, env(safe-area-inset-right));">
          
          <!-- Login Button -->
          <button 
            id="btnLogin" 
            class="icon-btn" 
            title="Login (Owner only)" 
            aria-label="Login"
            data-i18n-title="auth_login"
            style="width:36px;height:36px;display:inline-flex;align-items:center;justify-content:center;border:none;border-radius:10px;cursor:pointer;background:linear-gradient(180deg, color-mix(in srgb, #2563eb 92%, #fff 8%), #2563eb);color:#fff;box-shadow:0 6px 16px rgba(0,0,0,.18);">
            <i class="fa-solid fa-right-to-bracket"></i>
          </button>
          
          <!-- Logout Button -->
          <button 
            id="btnLogout" 
            class="icon-btn" 
            title="Logout" 
            aria-label="Logout"
            data-i18n-title="auth_logout"
            style="display:none;width:36px;height:36px;display:inline-flex;align-items:center;justify-content:center;border:none;border-radius:10px;cursor:pointer;background:linear-gradient(180deg, color-mix(in srgb, #ef4444 92%, #fff 8%), #ef4444);color:#fff;box-shadow:0 6px 16px rgba(0,0,0,.18);">
            <i class="fa-solid fa-right-from-bracket"></i>
          </button>
          
          <!-- Add Digital Product Button -->
          <button 
            id="btnAddProduct" 
            class="param-btn" 
            title="Add product"
            data-i18n-title="manage_add_product"
            style="display:none;height:36px;display:inline-flex;align-items:center;gap:8px;border:none;border-radius:10px;padding:0 12px;background:linear-gradient(180deg, color-mix(in srgb, #16a34a 92%, #fff 8%), #16a34a);color:#fff;font-weight:700;box-shadow:0 6px 16px rgba(0,0,0,.18);">
            <i class="fa-solid fa-plus"></i> 
            <span data-i18n="manage_add_digital">numerique</span>
          </button>
          
          <!-- Add Physical Product Button -->
          <button 
            id="btnAddPhysical" 
            class="param-btn owner-tool" 
            title="Ajouter produit physique"
            data-i18n-title="manage_add_physical"
            style="display:none;height:36px;display:inline-flex;align-items:center;gap:6px;border:none;border-radius:10px;padding:0 12px;background:linear-gradient(180deg, color-mix(in srgb, #10b981 92%, #fff 8%), #10b981);color:#fff;font-weight:700;box-shadow:0 6px 16px rgba(0,0,0,.18);">
            <i class="fa-solid fa-box"></i> 
            <span data-i18n="manage_add_physical">Physique</span>
          </button>
        </div>
      </header>

      <!-- Toolbar: Search + Filters -->
      <div class="shop-toolbar" role="region" aria-label="Recherche et filtres" style="display:grid;gap:10px;margin:6px 0 10px;">
        
        <!-- Search -->
        <div class="search" style="position:relative">
          <label for="search" class="sr-only" data-i18n="search_placeholder">Recherche produits</label>
          
          <!-- Search Icon -->
          <i class="fa-solid fa-magnifying-glass" style="position:absolute;left:12px;top:50%;transform:translateY(-50%);color:#909aa3;font-size:16px;pointer-events:none;z-index:1"></i>
          
          <!-- Input -->
          <input
            id="search"
            type="search"
            placeholder="Rechercher..."
            aria-label="Recherche produits"
            data-i18n="search_placeholder"
            data-i18n-placeholder
            autocomplete="off"
            inputmode="search"
            style="width:100%;height:40px;padding:8px 12px 8px 38px;border:1px solid #cfd6df;background-color:#ffffff;color:#111111;border-radius:999px;outline:none;font-size:14px;box-shadow:0 1px 2px rgba(0,0,0,.04)">
        </div>

        <!-- Filters -->
        <div class="filters" id="filters" role="toolbar" aria-label="Filtrer les produits" style="display:flex;gap:8px;overflow-x:auto;padding-bottom:2px;-webkit-overflow-scrolling:touch;scrollbar-width:none;-ms-overflow-style:none;">
          
          <button type="button" class="filter-btn active" data-category="all" data-i18n="filter_all"
            style="flex:0 0 auto;height:34px;padding:0 12px;border:1px solid rgba(0,0,0,0.08);background:#f7f9fc;color:#111;border-radius:999px;font-size:13px;font-weight:600;cursor:pointer;transition:all 0.2s ease;">
            Tous
          </button>
          
          <button type="button" class="filter-btn" data-category="ebooks" data-i18n="filter_ebooks"
            style="flex:0 0 auto;height:34px;padding:0 12px;border:1px solid rgba(0,0,0,0.08);background:#f7f9fc;color:#111;border-radius:999px;font-size:13px;font-weight:600;cursor:pointer;transition:all 0.2s ease;">
            Ebooks
          </button>
          
          <button type="button" class="filter-btn" data-category="videos" data-i18n="filter_videos"
            style="flex:0 0 auto;height:34px;padding:0 12px;border:1px solid rgba(0,0,0,0.08);background:#f7f9fc;color:#111;border-radius:999px;font-size:13px;font-weight:600;cursor:pointer;transition:all 0.2s ease;">
            Vidéos
          </button>
          
          <button type="button" class="filter-btn" data-category="vip" data-i18n="filter_vip"
            style="flex:0 0 auto;height:34px;padding:0 12px;border:1px solid rgba(0,0,0,0.08);background:#f7f9fc;color:#111;border-radius:999px;font-size:13px;font-weight:600;cursor:pointer;transition:all 0.2s ease;">
            VIP
          </button>
          
          <button type="button" class="filter-btn" data-category="promo" data-i18n="filter_promo"
            style="flex:0 0 auto;height:34px;padding:0 12px;border:1px solid rgba(0,0,0,0.08);background:#f7f9fc;color:#111;border-radius:999px;font-size:13px;font-weight:600;cursor:pointer;transition:all 0.2s ease;">
            Promo
          </button>
          
          <button type="button" class="filter-btn" data-category="apps" data-i18n="filter_apps"
            style="flex:0 0 auto;height:34px;padding:0 12px;border:1px solid rgba(0,0,0,0.08);background:#f7f9fc;color:#111;border-radius:999px;font-size:13px;font-weight:600;cursor:pointer;transition:all 0.2s ease;">
            Apps
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Products Grid -->
  <div id="products-container" class="products-grid" role="region" aria-label="Liste des produits">
    <!-- Products will be loaded here by JavaScript -->
  </div>
</section>

<!-- ========================================
     CART SECTION
     ======================================== -->
<section id="cart" class="section" aria-label="Panier d'achat" aria-hidden="true">
  <div class="cart-header">
    <h2 data-i18n="cart_title">Mon Panier</h2>
  </div>
  
  <div id="cart-items" class="cart-items">
    <!-- Cart items will be loaded here -->
  </div>
  
  <div class="cart-summary">
    <div class="cart-total">
      <span data-i18n="cart_total">Total:</span>
      <span id="cart-total-amount">0 AR</span>
    </div>
    
    <button 
      id="btnCheckout" 
      class="btn-checkout"
      data-i18n="cart_checkout">
      Passer la commande
    </button>
  </div>
</section>

<!-- ========================================
     PROFILE SECTION
     ======================================== -->
<section id="profile" class="section" aria-label="Profil utilisateur" aria-hidden="true">
  <div class="profile-header">
    <h2 data-i18n="profile_title">Mon Profil</h2>
  </div>
  
  <div class="profile-content">
    <!-- Profile content will be loaded here -->
  </div>
</section>

<!-- ========================================
     BOTTOM NAVIGATION
     ======================================== -->
<nav class="bottom-menu" role="navigation" aria-label="Navigation principale">
  <button type="button" class="menu-item active" data-page="home" aria-label="Accueil">
    <i class="fa-solid fa-house"></i>
    <span data-i18n="nav_home">Accueil</span>
  </button>
  
  <button type="button" class="menu-item" data-page="shop" aria-label="Boutique">
    <i class="fa-solid fa-shop"></i>
    <span data-i18n="nav_shop">Shop</span>
  </button>
  
  <button type="button" class="menu-item" data-page="cart" aria-label="Panier">
    <i class="fa-solid fa-cart-shopping"></i>
    <span data-i18n="nav_cart">Panier</span>
    <span id="cart-badge" class="badge" style="display:none;">0</span>
  </button>
  
  <button type="button" class="menu-item" data-page="profile" aria-label="Profil">
    <i class="fa-solid fa-user"></i>
    <span data-i18n="nav_profile">Profil</span>
  </button>
</nav>

<!-- Scripts -->
<script src="app.js"></script>

</body>
</html>