<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1, viewport-fit=cover" />
  <title>Mijoro Boutique â€” Version Pro</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <link rel="stylesheet" href="style.css">

  <noscript>
    <style>
      #loader{ display:none !important; }
      .bottom-menu{ display:flex !important; }
      section{ display:block !important; }
    </style>
  </noscript>
</head>
<body aria-busy="true">
  <!-- Loader -->
  <div id="loader" aria-hidden="false" role="status" aria-label="Chargement">
    <img class="loader-logo" src="https://i.ibb.co/p6CWgYWd/Logo.png" alt="Logo Mijoro" width="92" height="92" decoding="async">
    <div class="loader-text">Mijoro</div>
  </div>

  <!-- Sections: Home -->
  <section id="home" class="active" aria-label="Accueil" aria-hidden="false">
    <div class="slideshow" aria-label="Promotion">
      <div class="slide-track" id="slide-track">
        <!-- Add your slides here -->
        <div class="slide">
          <a href="#"><img src="https://i.ibb.co/DP1xT5Ky/8b7e15f5dd5dd2290ac52af728cc12c3.jpg" alt="Offre promo 1"></a>
        </div>
        <div class="slide">
          <a href="#"><img src="https://i.ibb.co/B5vcHVZX/ddce6f18e3cdf72f038584cdb034bbd0.jpg" alt="Offre promo 2"></a>
        </div>
        <!-- ... More slides ... -->
      </div>
      <div class="slide-dots" id="slide-dots" aria-hidden="true"></div>
    </div>
    <h1 id="home-title" data-i18n="home_title">Tongasoa ATO amin'ny boutique anay!</h1>
    <p id="home-sub" data-i18n="home_sub">DÃ©couvre des eBooks, vidÃ©os et apps/jeux pour tâ€™aider Ã  rÃ©ussir en ligne.</p>
  </section>

  <!-- Shop section -->
  <section id="shop" aria-label="Boutique - Produits numÃ©riques" aria-hidden="true">
    <h2>Nos Produits NumÃ©riques</h2>
    <div class="filters" id="shop-filters" role="toolbar" aria-label="Filtrer les produits">
      <button type="button" class="filter-btn active" data-filter="all" data-i18n="filter_all">Tous</button>
      <button type="button" class="filter-btn" data-filter="ebooks" data-i18n="filter_ebooks">Ebooks</button>
      <button type="button" class="filter-btn" data-filter="videos" data-i18n="filter_videos">VidÃ©os</button>
      <button type="button" class="filter-btn" data-filter="vip" data-i18n="filter_vip">VIP</button>
      <button type="button" class="filter-btn" data-filter="promo" data-i18n="filter_promo">Promo</button>
      <button type="button" class="filter-btn" data-filter="free" data-i18n="filter_free">Gratuit</button>
    </div>
    <div class="products-section" aria-live="polite">
      <div id="products-row" class="products-row" role="list" aria-label="Liste des produits â€” dÃ©filement vertical"></div>
    </div>
  </section>

  <!-- Shop popup (overlay) -->
  <div id="shop-popup" role="dialog" aria-modal="true" aria-hidden="true" tabindex="-1">
    <button type="button" class="close-popup" aria-label="Fermer" onclick="closeShop()"><i class="fa-solid fa-xmark"></i></button>
    <div class="filters" id="filters" role="toolbar" aria-label="Filtres Produits (popup)">
      <button type="button" class="filter-btn active" data-category="ebooks" data-i18n="filter_ebooks">eBooks</button>
      <button type="button" class="filter-btn" data-category="apps" data-i18n="filter_vip">Apps/Jeux</button>
      <button type="button" class="filter-btn" data-category="videos" data-i18n="filter_videos">VidÃ©os</button>
    </div>
    <div class="search">
      <label for="search" class="sr-only">Recherche produits</label>
      <input id="search" placeholder="Rechercher..." aria-label="Recherche produits"
       data-i18n="search_placeholder" data-i18n-placeholder autocomplete="off" inputmode="search">
    </div>
    <div id="products-box" aria-live="polite"></div>
    <div class="pagination" id="pagination" role="navigation" aria-label="Pagination"></div>
  </div>

  <!-- Cart panel + drawer -->
  <div id="cart-panel" aria-live="polite">
    <button id="cart-toggle" title="Voir le panier" aria-label="Voir le panier"><i class="fa-solid fa-basket-shopping"></i></button>
    <button type="button" title="Vider le panier" onclick="clearCart()" aria-label="Vider le panier"><i class="fa-solid fa-trash"></i></button>
    <div>
      <span data-i18n="cart_label">Cart</span>: <strong id="cart-count">0</strong> â€¢
      <span data-i18n="cart_total">Total</span>: <strong id="cart-total">0 AR</strong>
    </div>
  </div>
  <div id="cart-drawer" aria-hidden="true" role="dialog" aria-label="Panier">
    <div id="cart-list"></div>
    <div class="cart-footer">
      <div>Total: <strong id="cart-total-drawer">0 AR</strong></div>
      <div style="display:flex; gap:8px;">
        <button type="button" class="param-btn" onclick="clearCart()"><i class="fa-solid fa-trash"></i> Vider</button>
        <button type="button" class="param-btn" onclick="checkoutWhatsApp()"><i class="fa-brands fa-whatsapp"></i> Commander</button>
      </div>
    </div>
  </div>

  <!-- Bottom menu -->
  <div class="bottom-menu" role="navigation" aria-label="Menu bas">
    <button type="button" class="menu-btn menu-home active" onclick="showSection('home', this)"><i class="fa-solid fa-house"></i><span>Home</span></button>
    <button type="button" class="menu-btn menu-shop" onclick="showSection('shop', this)"><i class="fa-solid fa-store"></i><span>Shop</span></button>
    <button type="button" class="menu-btn menu-param" onclick="toggleParamFixed()"><i class="fa-solid fa-gear"></i><span>ParamÃ¨tre</span></button>
  </div>

  <!-- Param fixed (right) -->
  <aside id="param-fixed" class="hidden" aria-hidden="true" role="region" aria-label="ParamÃ¨tres" inert>
    <div style="display:flex;align-items:center;gap:10px">
      <img src="https://i.ibb.co/zTvNMMQd/743c16d58accff74c1c37793816bd25f.jpg" alt="param" style="width:46px;height:46px;border-radius:8px;object-fit:cover;border:1px solid rgba(255,255,255,.06)">
      <div>
        <h4 style="margin-bottom:4px" data-i18n="param_settings">ParamÃ¨tres</h4>
        <small style="color:#ddd">Personnalisez votre expÃ©rience</small>
      </div>
    </div>
    <!-- Langue -->
    <div>
      <h4 data-i18n="param_language">Langue</h4>
      <div class="option-grid" id="lang-options">
        <button type="button" class="option-card" data-lang="mg" onclick="selectLang('mg')">
          <div class="option-icon icon-mg">ðŸ‡²ðŸ‡¬</div>
          <div class="option-texts">
            <div class="option-title">Malagasy</div>
            <div class="option-sub">Lazao aminâ€™ny fiteny gasy</div>
          </div>
        </button>
        <button type="button" class="option-card" data-lang="fr" onclick="selectLang('fr')">
          <div class="option-icon icon-fr">ðŸ‡«ðŸ‡·</div>
          <div class="option-texts">
            <div class="option-title">FranÃ§ais</div>
            <div class="option-sub">Interface en franÃ§ais</div>
          </div>
        </button>
        <button type="button" class="option-card" data-lang="en" onclick="selectLang('en')">
          <div class="option-icon icon-en">ðŸ‡¬ðŸ‡§</div>
          <div class="option-texts">
            <div class="option-title">English</div>
            <div class="option-sub">English interface</div>
          </div>
        </button>
      </div>
    </div>
    <!-- ThÃ¨me -->
    <div>
      <h4 data-i18n="param_theme">ThÃ¨me</h4>
      <div class="option-grid" id="theme-options">
        <button type="button" class="option-card" data-theme="dark" onclick="selectTheme('dark')">
          <div class="option-icon icon-dark"><i class="fa-solid fa-moon"></i></div>
          <div class="option-texts">
            <div class="option-title">Sombre</div>
            <div class="option-sub">RecommandÃ© (dÃ©faut)</div>
          </div>
        </button>
        <button type="button" class="option-card" data-theme="light" onclick="selectTheme('light')">
          <div class="option-icon icon-light"><i class="fa-solid fa-sun"></i></div>
          <div class="option-texts">
            <div class="option-title">Clair</div>
            <div class="option-sub">Plus lumineux</div>
          </div>
        </button>
        <!-- Rose/Jaune/Marron will be injected by app.js -->
      </div>
    </div>
    <div class="row" style="justify-content:space-between; margin-top:8px;">
      <button type="button" class="param-btn" onclick="openInfo('about')" data-i18n="about">Ã€ propos</button>
      <button type="button" class="param-btn" onclick="openInfo('contact')" data-i18n="contact">Contact</button>
      <button type="button" class="param-btn" onclick="openQuitModal()" data-i18n="quit">Quit</button>
    </div>
  </aside>

  <!-- Quit modal -->
  <div id="quit-modal" role="dialog" aria-modal="true" aria-hidden="true" tabindex="-1" aria-labelledby="quit-title">
    <div class="modal-card" role="document">
      <h3 id="quit-title">Voulez-vous quitter lâ€™application ?</h3>
      <p style="margin:8px 0 12px">Tsy ho very ny angon-drakitrao.</p>
      <div style="display:flex;justify-content:center;gap:10px;margin-top:8px">
        <button type="button" class="param-btn" onclick="closeQuitModal()">Annuler</button>
        <button type="button" class="param-btn" style="background:#ef4444;border-color:#ef4444" onclick="quitApp()">Quitter</button>
      </div>
    </div>
  </div>
  <!-- Info modal -->
  <div id="info-modal" role="dialog" aria-modal="true" aria-hidden="true" tabindex="-1" aria-labelledby="info-title">
    <div class="info-card" role="document">
      <h3 id="info-title">Informations</h3>
      <div id="info-content"></div>
      <div class="info-actions">
        <button type="button" class="param-btn" onclick="closeInfo()">Fermer</button>
      </div>
    </div>
  </div>

  <!-- Loader Guard + iOS VH patch -->
  <script>
  (function(){
    var MAX_WAIT_MS = 8000, SOFT_WAIT_MS = 400;
    function qs(s){ return document.querySelector(s); }
    function hideLoader(){
      var l = qs('#loader'); if(!l) return;
      l.classList.add('fade-out');
      l.setAttribute('aria-hidden','true');
      l.style.pointerEvents = 'none';
      setTimeout(function(){ l.style.display = 'none'; }, 500);
    }
    function revealBaseUI(){
      try {
        document.body.setAttribute('aria-busy','false');
        var home = document.getElementById('home');
        if (home){ home.classList.add('active'); home.setAttribute('aria-hidden','false'); }
        var bm = qs('.bottom-menu');
        if (bm){ bm.style.display = 'flex'; bm.style.pointerEvents = 'auto'; }
      } catch(_) {}
    }
    function onReady(cb){
      if (document.readyState === 'complete' || document.readyState === 'interactive') cb();
      else document.addEventListener('DOMContentLoaded', cb, { once: true });
    }
    onReady(function(){
      setTimeout(revealBaseUI, SOFT_WAIT_MS);
      setTimeout(function(){ hideLoader(); revealBaseUI(); }, MAX_WAIT_MS);
    });
  })();
  </script>
  <script>
  (function(){
    function setVH(){ var vh = window.innerHeight * 0.01; document.documentElement.style.setProperty('--vh', vh + 'px'); }
    window.addEventListener('resize', setVH);
    window.addEventListener('orientationchange', setVH);
    setVH();
  })();
  </script>
  <script src="app.js" defer></script>
</body>
    </html>
