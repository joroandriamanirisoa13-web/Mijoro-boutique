/* ================================
   Theme variables
   ================================ */
:root{
  --accent: #ff9800;
  --bg-card: rgba(255,255,255,0.12);
  --popup-bg: rgba(0,0,0,0.85);
  --text: #fff;
  --radius: 12px;

  --menu-home:#2563eb;  --menu-home-h:#1d4ed8;
  --menu-shop:#16a34a;  --menu-shop-h:#15803d;
  --menu-param:#14b8a6; --menu-param-h:#0d9488;

  --cat-ebooks: #3b82f6;
  --cat-apps:   #8b5cf6;
  --cat-videos: #ef4444;

  --cat-vip:   #eab308; /* amber */
  --cat-promo: #22c55e; /* green */
  --cat-free:  #3b82f6; /* blue */

  /* Haben'ny menu ambany ho an'ny home fixe */
  --bm-space: 96px;
}

/* ================================
   Theme variants (override for theme switch)
   ================================ */
body.theme-dark { }
body.theme-light {
  --bg-card: rgba(255,255,255,0.95);
  --popup-bg: rgba(255,255,255,0.95);
  --text: #111;
  --accent: #ff9800;
  --menu-home: #2563eb; --menu-home-h: #1d4ed8;
  --menu-shop: #16a34a; --menu-shop-h: #15803d;
}
body.theme-jaune {
  --accent: #f59e0b;
  --bg-card: rgba(255,243,205,0.14);
  --popup-bg: rgba(15,12,8,0.92);
  --text: #fff;
  --menu-home: #b45309; --menu-home-h: #92400e;
  --menu-shop: #b45309; --menu-shop-h: #92400e;
}
body.theme-rose {
  --accent: #fb7185;
  --bg-card: rgba(251,113,133,0.09);
  --popup-bg: rgba(10,6,10,0.88);
  --text: #fff;
}
body.theme-marron {
  --accent: #8b5e3c;
  --bg-card: rgba(139,94,60,0.12);
  --popup-bg: rgba(10,6,10,0.85);
  --text: #fff;
}

/* ================================
   Reset / Global
   ================================ */
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%}
body{
  font-family:'Montserrat',sans-serif;
  color:var(--text);
  background:url("https://i.ibb.co/F4sjXGCN/images-21.jpg") no-repeat center center fixed;
  background-size:cover;
  -webkit-font-smoothing:antialiased;
  transition: background-color .6s ease;
  overflow-x:hidden;
}

/* ================================
   Loader
   ================================ */
#loader{
  position:fixed;inset:0;display:flex;flex-direction:column;justify-content:center;align-items:center;
  background:linear-gradient(135deg,#1e88e5,#64b5f6);z-index:9999;transition:opacity .6s;
}
#loader.fade-out{opacity:0;visibility:hidden;pointer-events:none}
#loader[aria-hidden="true"]{display:none !important;opacity:0 !important;visibility:hidden !important;pointer-events:none !important;}
.loader-logo{width:92px;height:92px;border-radius:50%;object-fit:cover;margin-bottom:16px;box-shadow:0 8px 30px rgba(0,0,0,.35)}
.loader-text{font-weight:800;font-size:28px;background:linear-gradient(90deg,#ffd700,#fff);-webkit-background-clip:text;-webkit-text-fill-color:transparent}

/* ================================
   Sections
   ================================ */
section{
  position:relative; z-index:1;
  max-width:980px;margin:48px auto;padding:48px;border-radius:var(--radius);
  background:var(--bg-card); backdrop-filter: blur(6px);
  box-shadow:0 6px 30px rgba(0,0,0,.45);
  display:none;
  opacity:0;
  transition:opacity .45s;
  content-visibility:auto; contain-intrinsic-size:800px 600px;
}
section.active{display:block; opacity:1}
h1,h2{font-size:28px;margin-bottom:8px}
p{color:#eee;line-height:1.5}

/* ================================
   Slideshow
   ================================ */
.slideshow{position:relative;width:100%;max-height:320px;margin-bottom:16px;overflow:hidden;border-radius:12px;aspect-ratio:16/9}
.slide-track{display:flex;width:100%;height:100%;transition:transform .6s ease;will-change:transform}
.slide{min-width:100%;height:100%}
.slide img{width:100%;height:100%;object-fit:cover}
.slide-dots{position:absolute;left:50%;bottom:10px;transform:translateX(-50%);display:flex;gap:8px}
.dot{width:10px;height:10px;border-radius:999px;background:rgba(255,255,255,.5);border:0}
.dot.active{background:#fff}

/* ================================
   Popup (shop)
   ================================ */
#shop-popup{
  position:fixed;inset:0;display:flex;flex-direction:column;align-items:center;padding:70px 18px 24px;
  background:var(--popup-bg); z-index:2200; opacity:0; pointer-events:none; transform:scale(.98); transition:all .28s ease;
  overflow:auto;
}
#shop-popup.show{opacity:1; pointer-events:auto; transform:scale(1)}
.close-popup{position:absolute;right:18px;top:18px;background:rgba(255,255,255,.9);color:#000;border:none;padding:10px;border-radius:999px;cursor:pointer}

/* ================================
   Filters
   ================================ */
.filters{display:flex;gap:8px;flex-wrap:wrap;justify-content:center;margin-bottom:8px}
.filter-btn{
  border:1px solid rgba(255,255,255,.06);
  color:#fff;padding:8px 12px;border-radius:8px;cursor:pointer;
  transition: background .18s ease, transform .12s ease, border-color .18s ease, color .18s ease;
  background: rgba(255,255,255,0.02);
}
.filter-btn.active{ box-shadow: 0 8px 24px rgba(0,0,0,.35); transform: translateY(-2px) }

/* ================================
   Products (vertical grid, mobile-first)
   ================================ */
.products-section {
  margin-top:18px;
  padding-bottom:80px;
}
.products-row{
  display:grid !important;
  grid-template-columns: 1fr;
  gap:14px;
  padding-bottom:0;
  overflow:visible !important;
  -webkit-overflow-scrolling:auto;
  scroll-behavior:auto;
  scroll-snap-type:unset;
  scroll-padding:0;
  overscroll-behavior-x:auto;
  cursor:default;
  white-space:normal;
}
.products-row::-webkit-scrollbar,
.products-row::-webkit-scrollbar-thumb{height:0;background:transparent}

/* Card base */
.products-row .product-card{
  min-width:0 !important;
  width:100%;
  max-width:none !important;
  flex:initial !important;
  display:flex;
  flex-direction:column;
  justify-content:space-between;
  background:var(--bg-card);
  border:1px solid rgba(255,255,255,.08);
  border-radius:var(--radius);
  box-shadow:0 1px 2px rgba(0,0,0,.2), 0 6px 18px rgba(0,0,0,.18);
  overflow:hidden;
  scroll-snap-align:none;
}
.product-card img{
  width:100%;
  height:auto;
  aspect-ratio:16/9;
  object-fit:cover;
}
.product-price{font-weight:900;font-size:16px;margin-top:6px}

@media (min-width: 640px){
  .products-row{ grid-template-columns: repeat(2, minmax(0, 1fr)); }
}
@media (min-width: 1024px){
  .products-row{ grid-template-columns: repeat(3, minmax(0, 1fr)); }
}

.products-grid{
  display:grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap:12px;
}

/* ================================
   Badges stylés
   ================================ */
.badge{
  display:inline-flex;align-items:center;gap:6px;padding:6px 8px;border-radius:999px;font-size:12px;
  background: rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.08);
}
.badge i{font-size:12px}
.badge-ebooks{ background-color: rgba(59,130,246,0.08); border-color: rgba(59,130,246,0.16); }
.badge-videos{ background-color: rgba(239,68,68,0.08); border-color: rgba(239,68,68,0.16); }
.badge-vip{ background: rgba(234,179,8,.18); border-color: rgba(234,179,8,.36); color:#fff;}
.badge-promo{ background: rgba(34,197,94,.18); border-color: rgba(34,197,94,.36); color:#fff;}
.badge-free{ background: rgba(59,130,246,.18); border-color: rgba(59,130,246,.36); color:#fff;}
@supports (color: color-mix(in srgb, black 10%, white 90%)) {
  .badge-ebooks{ background: color-mix(in srgb, var(--cat-ebooks) 20%, transparent); border-color: color-mix(in srgb, var(--cat-ebooks) 30%, transparent); }
  .badge-videos{ background: color-mix(in srgb, var(--cat-videos) 20%, transparent); border-color: color-mix(in srgb, var(--cat-videos) 30%, transparent); }
}

/* ================================
   Icon buttons (info/buy) + Patch look in cards
   ================================ */
.icon-btn{
  width:34px;height:34px;display:inline-flex;align-items:center;justify-content:center;
  border-radius:10px;border:1px solid rgba(255,255,255,.08);background:rgba(255,255,255,.06);color:var(--text);cursor:pointer;
  transition: transform .12s ease, box-shadow .2s ease, background .2s ease, border-color .2s ease;
}
.icon-btn:active{ transform: translateY(0) }
.icon-buy{ background: rgba(34,197,94,.16); border-color: rgba(34,197,94,.3); }
.icon-info{ background: rgba(255,255,255,.06); }

/* Product-card icons */
.product-card .icon-btn{
  width: 38px; height: 38px; border-radius: 12px;
  border: 1px solid rgba(255,255,255,.10);
  background: rgba(255,255,255,.06);
  color: #fff;
  display: inline-flex; align-items: center; justify-content: center;
  transition: transform .12s ease, box-shadow .2s ease, background .2s ease, border-color .2s ease, filter .2s ease;
}
.product-card .icon-btn i{ font-size: 16px; line-height: 1; }
.product-card .icon-buy{
  background: rgba(37,211,102,.18); border-color: rgba(37,211,102,.38); color: #eafff2;
}
.product-card .icon-buy:hover{
  background: rgba(37,211,102,.28); border-color: rgba(37,211,102,.55); filter: brightness(1.05);
}
.product-card .icon-info{
  background: rgba(255,255,255,.07); border-color: rgba(255,255,255,.12);
}
.product-card .icon-info:hover{
  background: rgba(255,255,255,.12); border-color: rgba(255,255,255,.22);
}
.product-card .icon-btn + .icon-btn{ margin-left: 8px; }
.product-card .product-price{ white-space: nowrap; }
.product-card .meta, .product-card .product-meta{ gap: 10px; }
@media (max-width: 420px){
  .product-card .icon-btn{ width: 40px; height: 40px; border-radius: 12px; }
  .product-card h3{ font-size: 14px; }
}
.product-card .card-actions{
  display: inline-flex; align-items: center; gap: 10px; flex-wrap: nowrap;
}

/* ================================
   Like/heart + burst effect
   ================================ */
.icon-like{
  position:relative;color:#fff;background:rgba(255,255,255,.06);
  border:1px solid rgba(255,255,255,.08); width:34px;height:34px;
  display:inline-flex;align-items:center;justify-content:center;border-radius:10px;cursor:pointer;
}
.icon-like.liked{ color:#ef4444; background: rgba(239,68,68,.18); border-color: rgba(239,68,68,.4); }
.icon-like.burst::after{
  content:""; position:absolute; inset:0; border-radius:12px;
  box-shadow: 0 -14px 0 -8px #ef4444, 14px 0 0 -8px #f59e0b, 0 14px 0 -8px #10b981, -14px 0 0 -8px #3b82f6;
  animation: burst .45s ease-out;
}
@keyframes burst{
  0%{ transform:scale(.6); opacity:.9 }
  80%{ transform:scale(1.4); opacity:.2 }
  100%{ transform:scale(1.6); opacity:0 }
}

/* ================================
   Cart panel (top-right)
   ================================ */
#cart-panel{
  position:fixed;right:14px;top:14px;background:rgba(0,0,0,.6);padding:8px 12px;border-radius:10px;z-index:1500;display:flex;gap:10px;align-items:center
}
#cart-panel button{background:transparent;border:0;color:#fff;cursor:pointer}

/* ================================
   Cart drawer (modern)
   ================================ */
#cart-drawer{
  position: fixed; right: 12px; bottom: 64px;
  width: min(360px, 92vw); max-height: 70vh; overflow:auto;
  background: var(--popup-bg); color: var(--text);
  border-radius: 12px; padding: 12px; z-index: 1600;
  box-shadow: 0 18px 60px rgba(0,0,0,.55);
  transform: translateY(12px); opacity:0; pointer-events:none; transition: transform .18s, opacity .18s;
}
#cart-drawer.show{ transform: translateY(0); opacity:1; pointer-events:auto; }
.cart-item{ display:grid; grid-template-columns:56px 1fr auto; gap:10px; align-items:center; padding:8px; border-radius:10px;
  background: rgba(255,255,255,.04); border:1px solid rgba(255,255,255,.06); }
.cart-item img{ width:56px; height:56px; object-fit:cover; border-radius:8px; }
.cart-item h4{ font-size:14px; margin:0; color:var(--text);}
.cart-item .qty{ display:flex; align-items:center; gap:6px; margin-top:6px;}
.cart-item .qty button{ width:26px; height:26px; border-radius:6px; border:1px solid rgba(255,255,255,.12); background:rgba(255,255,255,.06); color:var(--text); cursor:pointer; }
.cart-footer{ display:flex; justify-content:space-between; align-items:center; padding-top:10px; border-top:1px dashed rgba(255,255,255,.18); margin-top:10px; }
.cart-empty{ color:#ddd; padding:10px; text-align:center; }

/* ================================
   Bottom menu (z-index surélevé + cliquable)
   ================================ */
.bottom-menu{
  position:fixed;left:50%;transform:translateX(-50%);
  bottom:12px;display:flex;gap:12px;
  background:rgba(15,23,42,.65);
  padding:10px 14px;border-radius:28px;
  z-index:3200;
  backdrop-filter: blur(6px);
  pointer-events:auto;
}
.menu-btn{
  background:none;border:0;color:#fff;
  display:flex;flex-direction:column;align-items:center;gap:4px;
  padding:8px 10px;border-radius:12px;cursor:pointer;min-width:84px;
  transition: background .18s ease, transform .12s ease, box-shadow .2s ease;
  box-shadow: 0 6px 18px rgba(0,0,0,.22);
}
.menu-btn i{font-size:18px}
.menu-home{ background:var(--menu-home) }
.menu-shop{ background:var(--menu-shop) }
.menu-param{ background:var(--menu-param) }
.menu-home:hover{ background:var(--menu-home-h); transform: translateY(-1px) }
.menu-shop:hover{ background:var(--menu-shop-h); transform: translateY(-1px) }
.menu-param:hover{ background:var(--menu-param-h); transform: translateY(-1px) }
.menu-btn:active{ transform: translateY(0) }
.menu-btn.active{
  outline: 2px solid rgba(255,255,255,.5);
  outline-offset: 2px;
  box-shadow: 0 10px 24px rgba(0,0,0,.28), 0 0 0 4px rgba(255,255,255,.12) inset;
}
@keyframes pulseOnce {
  0% { transform: scale(1); box-shadow: 0 0 0 rgba(255,255,255,0); }
  40% { transform: scale(1.06); box-shadow: 0 0 0 8px rgba(255,255,255,0.18); }
  100% { transform: scale(1); box-shadow: 0 0 0 rgba(255,255,255,0); }
}
.menu-shop.pulse { animation: pulseOnce .45s ease-out; }

/* ================================
   Param fixed (right)
   ================================ */
#param-fixed{
  position:fixed; right:12px; bottom:100px; width:300px; max-width:92%;
  background:var(--popup-bg); padding:12px;border-radius:12px; z-index:2400; color:var(--text);
  box-shadow:0 12px 40px rgba(0,0,0,.6);
  display:flex;flex-direction:column;gap:10px;align-items:stretch;
  transition:transform .18s,opacity .18s;
  max-height:70vh; overflow:auto; pointer-events:auto;
}
#param-fixed.hidden{transform:translateY(18px);opacity:0;pointer-events:none}
#param-fixed .row{display:flex;gap:8px;align-items:center}
#param-fixed h4{margin:10px 0 6px 0;font-size:14px}

.param-btn{padding:8px 10px;border-radius:8px;border:1px solid rgba(255,255,255,.06);background:rgba(255,255,255,.03);color:var(--text);cursor:pointer}
.param-select{display:flex;flex-direction:column;gap:6px}

/* ================================
   Option cards (Langue / Thème)
   ================================ */
.option-grid{ display:grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap:10px; }
.option-card{
  display:flex; align-items:center; gap:10px;
  background: rgba(255,255,255,.06);
  border:1px solid rgba(255,255,255,.08);
  border-radius:12px; padding:10px 12px; cursor:pointer;
  transition: transform .12s ease, box-shadow .2s ease, border-color .2s ease, background .2s ease;
  position:relative; color:var(--text);
}
.option-card:hover{ transform: translateY(-1px); box-shadow: 0 10px 24px rgba(0,0,0,.28); }
.option-card.active{ border-color: rgba(255,255,255,.35); box-shadow: 0 10px 28px rgba(0,0,0,.35), 0 0 0 2px rgba(255,255,255,.18) inset; }

.option-icon{
  width:38px; height:38px; border-radius:999px;
  display:flex; align-items:center; justify-content:center;
  color:#fff; font-size:18px; flex:0 0 auto;
  box-shadow: inset 0 -2px 8px rgba(0,0,0,.25);
}
.option-texts{ display:flex; flex-direction:column; text-align:left }
.option-title{ font-weight:800; font-size:14px; line-height:1.1 }
.option-sub{ font-size:12px; opacity:.9 }

.option-card.active::after{
  content: "\f00c";
  font-family: "Font Awesome 6 Free"; font-weight:900;
  position:absolute; right:8px; top:8px; font-size:12px;
  color:#10b981;
  background: rgba(16,185,129,.14);
  border:1px solid rgba(16,185,129,.35);
  width:20px; height:20px; border-radius:999px;
  display:flex; align-items:center; justify-content:center;
}

/* Icons for language/theme chips */
.icon-mg{ background: linear-gradient(135deg,#ef4444,#22c55e) }
.icon-fr{ background: linear-gradient(135deg,#2563eb,#ef4444) }
.icon-en{ background: linear-gradient(135deg,#111827,#3b82f6) }
.icon-dark{ background: linear-gradient(135deg,#0f172a,#334155) }
.icon-light{ background: linear-gradient(135deg,#f59e0b,#fde68a); color:#111 }

/* ================================
   Modals (Quit / Info)
   ================================ */
#quit-modal,#info-modal{
  position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.6);z-index:3000;opacity:0;pointer-events:none;
  transition: opacity .18s ease; will-change:opacity;
}
#quit-modal.show,#info-modal.show{opacity:1;pointer-events:auto}
.modal-card{background:var(--bg-card);padding:18px;border-radius:12px;max-width:420px;text-align:center;backdrop-filter: blur(4px)}
.info-card{background:var(--bg-card);padding:18px;border-radius:12px;max-width:520px;backdrop-filter: blur(4px)}
.info-card h3{margin-bottom:8px}
.info-actions{display:flex;justify-content:flex-end;gap:8px;margin-top:10px}

/* ================================
   Focus rings (accessibility)
   ================================ */
.menu-btn:focus-visible,
.page-btn:focus-visible,
.filter-btn:focus-visible,
.param-btn:focus-visible,
.close-popup:focus-visible,
.dot:focus-visible{
  outline:3px solid #fff; outline-offset:3px;
}

/* ================================
   Screen reader only
   ================================ */
.sr-only{
  position:absolute !important;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0;
}

/* ================================
   Reduced motion
   ================================ */
@media (prefers-reduced-motion: reduce){
  *,*::before,*::after{
    animation-duration:.001ms !important;
    animation-iteration-count:1 !important;
    transition-duration:.001ms !important;
    scroll-behavior:auto !important;
  }
}

/* ================================
   Mobile optimisations
   ================================ */
@media(max-width:720px){
  #products-box{grid-template-columns:repeat(auto-fit,minmax(160px,1fr))}
  #param-fixed{right:8px;left:8px;width:auto}
  .products-row .product-card{
    min-width: 0 !important;
    width: 100%;
  }
}
@media (max-width:480px){
  body{ background-attachment:scroll }
  .bottom-menu{ backdrop-filter:none; background:rgba(15,23,42,.85) }
  #param-fixed{ background: rgba(0,0,0,.82); backdrop-filter:none }
  .modal-card,.info-card{ backdrop-filter:none; background: rgba(0,0,0,.7); }
}

/* ================================
   HOME fixe (tsy scroll) + slideshow cover
   ================================ */
#home.home-fixed{
  display: flex;
  flex-direction: column;
  height: calc(var(--vh, 1vh) * 100 - var(--bm-space));
  margin: 12px auto;
  padding: 12px;
  overflow: hidden;
  background: var(--bg-card);
  border-radius: var(--radius);
  box-shadow: 0 6px 18px rgba(0,0,0,.35);
}
#home.home-fixed .slideshow{
  flex: 1 1 auto;
  min-height: 0;
  height: auto;
  max-height: none;
}
#home.home-fixed .slide-track,
#home.home-fixed .slide{
  height: 100%;
}
#home.home-fixed .slide img{
  width: 100%;
  height: 100%;
  object-fit: cover;
  object-position: center center;
  aspect-ratio: auto;
}
@media (max-width: 480px){
  #home.home-fixed h1 { font-size: 22px; }
  #home.home-fixed p  { font-size: 13px; }
}